import os
import logging
from datetime import datetime, date, timedelta
import psycopg2
from psycopg2.extras import RealDictCursor
import json

logger = logging.getLogger(__name__)
class DatabaseManager:
    def __init__(self):
        self.database_url = os.environ.get('DATABASE_URL')
    
    def get_connection(self):
        """–°–æ–∑–¥–∞–µ—Ç —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —Å PostgreSQL —Å –ø–æ–≤—Ç–æ—Ä–Ω—ã–º–∏ –ø–æ–ø—ã—Ç–∫–∞–º–∏"""
        import psycopg2
        from psycopg2.extras import RealDictCursor
        import time
        
        max_retries = 3
        retry_delay = 2
        
        for attempt in range(max_retries):
            try:
                conn = psycopg2.connect(
                    self.database_url,
                    sslmode='require',
                    connect_timeout=10,
                    keepalives=1,
                    keepalives_idle=30,
                    keepalives_interval=10,
                    keepalives_count=5
                )
                return conn
            except (psycopg2.OperationalError, psycopg2.InterfaceError) as e:
                if attempt < max_retries - 1:
                    logging.warning(f"‚ö†Ô∏è Database connection attempt {attempt + 1} failed: {e}")
                    logging.info(f"üîÑ Retrying in {retry_delay} seconds...")
                    time.sleep(retry_delay)
                    retry_delay *= 2  # –≠–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞
                else:
                    logging.error(f"‚ùå Failed to connect to database after {max_retries} attempts: {e}")
                    raise
            except Exception as e:
                logging.error(f"‚ùå Unexpected database connection error: {e}")
                raise
    
    def init_database(self):
        """–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ç–∞–±–ª–∏—Ü –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö"""
        conn = self.get_connection()
        cursor = conn.cursor()
        
        try:
            
            # –¢–∞–±–ª–∏—Ü–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π 
            cursor.execute(f'''
                CREATE TABLE IF NOT EXISTS users (
                    user_id BIGINT PRIMARY KEY,
                    username TEXT,
                    first_name TEXT,
                    last_name TEXT,
                    email TEXT,
                    registered_date TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
                    phone TEXT
                )
            ''')

            # –¢–∞–±–ª–∏—Ü–∞ –∫–æ–Ω—Ç–µ–Ω—Ç–∞ –∫—É—Ä—Å–∞
            cursor.execute('''
                CREATE TABLE IF NOT EXISTS course_content (
                    day_number INTEGER PRIMARY KEY,
                    messages JSONB NOT NULL,
                    has_images BOOLEAN DEFAULT FALSE,
                    image_urls TEXT[]
                )
            ''')
            
            # –¢–∞–±–ª–∏—Ü–∞ –¥–ª—è –º–∞—Ä–∞—Ñ–æ–Ω–∞
            cursor.execute('''
                CREATE TABLE IF NOT EXISTS marathon_content (
                    id SERIAL PRIMARY KEY,
                    messages JSONB NOT NULL
                )
            ''')
            
            cursor.execute('''
                CREATE TABLE IF NOT EXISTS marathon_purchases (
                    id SERIAL PRIMARY KEY,
                    user_id BIGINT REFERENCES users(user_id),
                    payment_id VARCHAR(100) UNIQUE,
                    start_date DATE,
                    is_active BOOLEAN DEFAULT TRUE,
                    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
                )
            ''')

            cursor.execute('''
                CREATE TABLE IF NOT EXISTS course_progress (
                    id SERIAL PRIMARY KEY,
                    user_id BIGINT UNIQUE REFERENCES users(user_id),
                    current_day INTEGER DEFAULT 1,
                    last_message_date TIMESTAMP,  -- –ò–∑–º–µ–Ω–∏–ª–∏ last_message_time –Ω–∞ last_message_date
                    is_active BOOLEAN DEFAULT TRUE,
                    completed_at TIMESTAMP,
                    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
                )
            ''')
            conn.commit()
            
            # –ó–∞–ø–æ–ª–Ω—è–µ–º –∫–æ–Ω—Ç–µ–Ω—Ç –∫—É—Ä—Å–∞ –µ—Å–ª–∏ –ø—É—Å—Ç–æ
            self.initialize_course_content()
            
            logger.info("‚úÖ Database tables created/verified")
            
        except Exception as e:
            logger.error(f"‚ùå Error initializing database: {e}")
            conn.rollback()
            raise
        finally:
            conn.close()

    def initialize_course_content(self):
        """–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç –∫–æ–Ω—Ç–µ–Ω—Ç 7-–¥–Ω–µ–≤–Ω–æ–≥–æ –∫—É—Ä—Å–∞ —Å –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π"""
        print("üîÑ –ù–∞—á–∏–Ω–∞—é –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—é –∫–æ–Ω—Ç–µ–Ω—Ç–∞ –∫—É—Ä—Å–∞...")  # –î–æ–±–∞–≤–∏–º print –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏
    
        conn = self.get_connection()
        if not conn:
            print("‚ùå –ù–µ—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –ë–î")
            return
        
        try:
            cursor = conn.cursor()
            
            # –°–Ω–∞—á–∞–ª–∞ –ø—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ —É–∂–µ –∫–æ–Ω—Ç–µ–Ω—Ç
            cursor.execute("SELECT COUNT(*) FROM course_content")
            count = cursor.fetchone()[0]
            
            print(f"üìä –ù–∞–π–¥–µ–Ω–æ –∑–∞–ø–∏—Å–µ–π –≤ course_content: {count}")
            
            if count == 0:
                print("üìù –°–æ–∑–¥–∞—é –∫–æ–Ω—Ç–µ–Ω—Ç –¥–ª—è –¥–Ω—è 1...")
                
                # –î–µ–Ω—å 1 - 3 —Å–æ–æ–±—â–µ–Ω–∏—è
                day1_messages = [
                    # –°–æ–æ–±—â–µ–Ω–∏–µ 1
                    "üëã **–ó–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ! –°–µ–≥–æ–¥–Ω—è ‚Äî –î–µ–Ω—å 1 –Ω–∞—à–µ–≥–æ –ø—É—Ç–µ—à–µ—Å—Ç–≤–∏—è: –†–∞–∑–±—É–¥–∏ —Å–≤–æ–µ–≥–æ –ú–µ—á—Ç–∞—Ç–µ–ª—è!**\n\n"
                    "–í–Ω—É—Ç—Ä–∏ –∫–∞–∂–¥–æ–≥–æ –∏–∑ –Ω–∞—Å –∂–∏–≤–µ—Ç **–í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π –†–µ–±–µ–Ω–æ–∫.** –ò–º–µ–Ω–Ω–æ —ç—Ç–∞ —á–∞—Å—Ç—å –ª–∏—á–Ω–æ—Å—Ç–∏ —É–º–µ–µ—Ç –º–µ—á—Ç–∞—Ç—å –ø–æ-–Ω–∞—Å—Ç–æ—è—â–µ–º—É. üë∂\n\n"
                    "–ß–µ–º —Å–≤–æ–±–æ–¥–Ω–µ–µ –í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π –†–µ–±–µ–Ω–æ–∫, —Ç–µ–º –ª–µ–≥—á–µ –Ω–∞–º –º–µ—á—Ç–∞—Ç—å –∏ –Ω–∞–ø–æ–ª–Ω—è—Ç—å –∂–µ–ª–∞–Ω–∏—è **—ç–Ω–µ—Ä–≥–∏–µ–π** –¥–ª—è –∏—Ö —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏.",
                    
                    # –°–æ–æ–±—â–µ–Ω–∏–µ 2
                    "‚ú® **–ó–∞–¥–∞–Ω–∏–µ –î–Ω—è: –°–æ–∑–¥–∞–µ–º –ë–∞–∑–æ–≤—ã–π –°–ø–∏—Å–æ–∫ –ñ–µ–ª–∞–Ω–∏–π**\n"
                    "–ü—Ä–∏–≥–æ—Ç–æ–≤—å—Ç–µ **—Ä—É—á–∫—É –∏ –ª–∏—Å—Ç –±—É–º–∞–≥–∏.** üìù\n\n"
                    "–°—è–¥—å—Ç–µ —É–¥–æ–±–Ω–æ, —Ä–∞—Å—Å–ª–∞–±—å—Ç–µ—Å—å. –ü—Ä–µ–¥—Å—Ç–∞–≤—å—Ç–µ —Å–≤–æ–µ–≥–æ **–í–Ω—É—Ç—Ä–µ–Ω–Ω–µ–≥–æ –ú–µ—á—Ç–∞—Ç–µ–ª—è,** –ø–æ–≥—Ä—É–∑–∏—Ç–µ—Å—å –≤ —ç—Ç–æ —Å–æ—Å—Ç–æ—è–Ω–∏–µ.\n\n"
                    "–ù–∞—á–∏–Ω–∞–π—Ç–µ –∑–∞–ø–∏—Å—ã–≤–∞—Ç—å **–≤—Å—ë, —á—Ç–æ –≤—Å–ø–æ–º–Ω–∏—Ç–µ.** –ù–ï –≤–∫–ª—é—á–∞–π—Ç–µ –ª–æ–≥–∏–∫—É –∏ –∑–¥—Ä–∞–≤—ã–π —Å–º—ã—Å–ª! –í—Å–ø–æ–º–Ω–∏—Ç–µ –∂–µ–ª–∞–Ω–∏—è –∏–∑ –ø—Ä–æ—à–ª–æ–≥–æ, –∞ –∑–∞—Ç–µ–º –¥–æ–±–∞–≤—å—Ç–µ —Ç–µ, —á—Ç–æ –∞–∫—Ç—É–∞–ª—å–Ω—ã —Å–µ–π—á–∞—Å.\n\n"
                    "**–ü—Ä–∏–º–µ—Ä—ã —Ç–æ–≥–æ, —á—Ç–æ –∑–∞–ø–∏—Å—ã–≤–∞–µ–º:**\n"
                    "‚Ä¢ üíñ –ñ–µ–ª–∞–Ω–∏—è, —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Å –ª—é–±–æ–≤—å—é, —Ç–µ–ø–ª–æ–º –∏ –∑–∞–±–æ—Ç–æ–π.\n"
                    "‚Ä¢ ü§∏‚Äç‚ôÄÔ∏è –ü–æ—Ç—Ä–µ–±–Ω–æ—Å—Ç–∏ (–æ—Ç–¥—ã—Ö, –µ–¥–∞, –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å).\n"
                    "‚Ä¢ üèÜ –¶–µ–ª–∏, –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è –∏ –º–∞—Ç–µ—Ä–∏–∞–ª—å–Ω—ã–µ –∂–µ–ª–∞–Ω–∏—è.\n"
                    "‚Ä¢ üåç –ù–æ–≤—ã–µ –≤–ø–µ—á–∞—Ç–ª–µ–Ω–∏—è –∏ –ø–æ–∑–Ω–∞–Ω–∏–µ –º–∏—Ä–∞.",
                    
                    # –°–æ–æ–±—â–µ–Ω–∏–µ 3
                    "‚úçÔ∏è **–ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ:**\n"
                    "–°–ø–∏—Å–æ–∫ –º–æ–∂–Ω–æ –¥–æ–ø–æ–ª–Ω—è—Ç—å, –ø–æ–∫–∞ –≤—ã –Ω–µ –ø–æ–ª—É—á–∏—Ç–µ —Å–ª–µ–¥—É—é—â–µ–µ –ø–∏—Å—å–º–æ –æ—Ç –º–µ–Ω—è!\n\n"
                    "–û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ **–°–û–•–†–ê–ù–ò–¢–ï –≠–¢–û–¢ –°–ü–ò–°–û–ö!** –û–Ω –ø–æ–Ω–∞–¥–æ–±–∏—Ç—Å—è –≤–∞–º –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –≤—Å–µ—Ö –ø–æ—Å–ª–µ–¥—É—é—â–∏—Ö –∑–∞–¥–∞–Ω–∏–π –∫—É—Ä—Å–∞.\n\n"
                    "‚è∞ **–î–æ –≤—Å—Ç—Ä–µ—á–∏ –∑–∞–≤—Ç—Ä–∞ –≤ —ç—Ç–æ –∂–µ –≤—Ä–µ–º—è!**"
                ]
                
                cursor.execute(
                    "INSERT INTO course_content (day_number, messages, has_images) VALUES (%s, %s, %s)",
                    (1, json.dumps(day1_messages, ensure_ascii=False), False)
                )
                
                # –î–µ–Ω—å 2 - 4 —Å–æ–æ–±—â–µ–Ω–∏—è + 2 –∫–∞—Ä—Ç–∏–Ω–∫–∏
                day2_messages = [
                    # –°–æ–æ–±—â–µ–Ω–∏–µ 1
                    "üëã **–ó–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ! –î–µ–Ω—å 2: –ö–æ–ª–µ—Å–æ –ñ–∏–∑–Ω–µ–Ω–Ω–æ–≥–æ –ë–∞–ª–∞–Ω—Å–∞!**\n\n"
                    "–ù–∞—à–∞ –∂–∏–∑–Ω—å –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –≥–∞—Ä–º–æ–Ω–∏—á–Ω–æ–π, –µ—Å–ª–∏ \"–ø—Ä–æ—Å–µ–¥–∞–µ—Ç\" –æ–¥–Ω–∞ –∏–∑ –≤–∞–∂–Ω—ã—Ö —Å—Ñ–µ—Ä. –≠—Ç–æ —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è —Å–µ—Ä—å–µ–∑–Ω—ã–º –ø—Ä–µ–ø—è—Ç—Å—Ç–≤–∏–µ–º –Ω–∞ –ø—É—Ç–∏ –∫ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –∂–µ–ª–∞–Ω–∏–π.\n\n"
                    "–ß—Ç–æ–±—ã —ç—Ç–æ –∏—Å–ø—Ä–∞–≤–∏—Ç—å, –Ω–∞–º –Ω—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Å—Ç–∏ —á–µ—Å—Ç–Ω—ã–π **–∞–Ω–∞–ª–∏–∑** —Å–≤–æ–µ–π –∂–∏–∑–Ω–∏. üßê\n\n"
                    "–í —ç—Ç–æ–º –ø–æ–º–æ–∂–µ—Ç –º–æ—â–Ω—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç ‚Äî **–ö–æ–ª–µ—Å–æ –ñ–∏–∑–Ω–µ–Ω–Ω–æ–≥–æ –ë–∞–ª–∞–Ω—Å–∞.** üëá",
                    
                    # –°–æ–æ–±—â–µ–Ω–∏–µ 2 (–±—É–¥–µ—Ç –∫–∞—Ä—Ç–∏–Ω–∫–∞ 1)
                    "",  # –ü—É—Å—Ç–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –¥–ª—è –∫–∞—Ä—Ç–∏–Ω–∫–∏
                    
                    # –°–æ–æ–±—â–µ–Ω–∏–µ 3
                    "üõ†Ô∏è **–®–∞–≥ 1. –ê–Ω–∞–ª–∏–∑ –°—Ñ–µ—Ä—ã (–ü–∏—Å—å–º–µ–Ω–Ω–æ–µ –∑–∞–¥–∞–Ω–∏–µ)**\n\n"
                    "–í–æ–∑—å–º–∏—Ç–µ —Ä—É—á–∫—É –∏ –±—É–º–∞–≥—É. –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–π—Ç–µ 8 –∫–ª—é—á–µ–≤—ã—Ö —Å—Ñ–µ—Ä –≤–∞—à–µ–π –∂–∏–∑–Ω–∏:\n"
                    "‚Ä¢ **–°–µ–º—å—è, –ó–¥–æ—Ä–æ–≤—å–µ, –§–∏–Ω–∞–Ω—Å—ã, –ö–∞—Ä—å–µ—Ä–∞, –õ–∏—á–Ω–æ—Å—Ç–Ω—ã–π —Ä–æ—Å—Ç, –î—É—Ö–æ–≤–Ω–æ—Å—Ç—å, –û—Ç–¥—ã—Ö, –û—Ç–Ω–æ—à–µ–Ω–∏—è.**\n\n"
                    "–î–ª—è –∫–∞–∂–¥–æ–π —Å—Ñ–µ—Ä—ã –æ—Ç–≤–µ—Ç—å—Ç–µ –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã –∏ **–∑–∞–ø–∏—à–∏—Ç–µ –æ—Ç–≤–µ—Ç—ã:**\n"
                    "‚óæÔ∏è **–ù–∞—Å–∫–æ–ª—å–∫–æ —è —É–¥–æ–≤–ª–µ—Ç–≤–æ—Ä–µ–Ω(–∞) —ç—Ç–æ–π —Å—Ñ–µ—Ä–æ–π (–æ—Ç 0 –¥–æ 10 –±–∞–ª–ª–æ–≤)?** (0 ‚Äì —Å–æ–≤—Å–µ–º –Ω–µ —É–¥–æ–≤–ª–µ—Ç–≤–æ—Ä–µ–Ω(–∞), 10 ‚Äì –ø–æ–ª–Ω–æ—Å—Ç—å—é).\n"
                    "‚óæÔ∏è **–ß—Ç–æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ –Ω—É–∂–Ω–æ –ø—Ä–µ–¥–ø—Ä–∏–Ω—è—Ç—å –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è –≤ –±–ª–∏–∂–∞–π—à–µ–µ –≤—Ä–µ–º—è?**\n\n"
                    "**–ë—É–¥—å—Ç–µ –ø—Ä–µ–¥–µ–ª—å–Ω–æ —á–µ—Å—Ç–Ω—ã —Å —Å–æ–±–æ–π!**",
                    
                    # –°–æ–æ–±—â–µ–Ω–∏–µ 4
                    "üìä **–®–∞–≥ 2. –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –∏ –ö–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∞**\n\n"
                    "–ù–∞—Ä–∏—Å—É–π—Ç–µ –∏–ª–∏ —Ä–∞—Å–ø–µ—á–∞—Ç–∞–π—Ç–µ –ø—É—Å—Ç–æ–π –±–ª–∞–Ω–∫ –ö–æ–ª–µ—Å–∞ –ë–∞–ª–∞–Ω—Å–∞.\n\n"
                    "–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –∏ –∑–∞–∫—Ä–∞—Å—å—Ç–µ —Å–µ–∫—Ç–æ—Ä–∞ –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å –±–∞–ª–ª–∞–º–∏ (–æ—Ç 0 –¥–æ 10). –¶–≤–µ—Ç —Å—Ñ–µ—Ä—ã –≤—ã–±–∏—Ä–∞–π—Ç–µ –∏–Ω—Ç—É–∏—Ç–∏–≤–Ω–æ, –æ–Ω –º–æ–∂–µ—Ç –±—ã—Ç—å –ª—é–±—ã–º.\n\n"
                    "‚ùì **–ê–Ω–∞–ª–∏–∑:** –ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –Ω–∞ –∫–æ–ª–µ—Å–æ: –º–æ–∂–µ—Ç –ª–∏ –æ–Ω–æ –∫–∞—Ç–∏—Ç—å—Å—è, –Ω–∞—Å–∫–æ–ª—å–∫–æ —Å–≤–æ–±–æ–¥–Ω–æ —ç—Ç–æ –ø–æ–ª—É—á–∞–µ—Ç—Å—è? –ï—Å–ª–∏ –≤–∞—à–µ –∫–æ–ª–µ—Å–æ –ø–æ–ª—É—á–∏–ª–æ—Å—å —Å –±–æ–ª—å—à–∏–º–∏ –ø–µ—Ä–µ–ø–∞–¥–∞–º–∏, –≤–Ω–∏–º–∞—Ç–µ–ª—å–Ω–æ –ø–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –Ω–∞ **–æ—Ç—Å—Ç–∞—é—â–∏–µ —Å—Ñ–µ—Ä—ã.** –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤—å—Ç–µ —ç–Ω–µ—Ä–≥–∏—é –∏ —Ä–µ—Å—É—Ä—Å—ã —Å–æ —Å—Ñ–µ—Ä —Å –≤—ã—Å–æ–∫–∏–º–∏ –±–∞–ª–ª–∞–º–∏ –Ω–∞ –ø—Ä–æ—Å–µ–¥–∞—é—â–∏–µ.\n\n"
                    "‚û°Ô∏è **–ö–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∞ –°–ø–∏—Å–∫–∞ –ñ–µ–ª–∞–Ω–∏–π**\n"
                    "–í–µ—Ä–Ω–∏—Ç–µ—Å—å –∫ —Å–≤–æ–µ–º—É —Å–ø–∏—Å–∫—É –∂–µ–ª–∞–Ω–∏–π (–∏–∑ –î–Ω—è 1). –î–æ–ø–æ–ª–Ω–∏—Ç–µ –µ–≥–æ –Ω–æ–≤—ã–º–∏ –ø—É–Ω–∫—Ç–∞–º–∏: **—á—Ç–æ –ø–æ–º–æ–∂–µ—Ç —É–ª—É—á—à–∏—Ç—å \"–ø—Ä–æ—Å–µ–¥–∞—é—â–∏–µ\" —Å—Ñ–µ—Ä—ã?**\n\n"
                    "**–ù–∞–ø—Ä–∏–º–µ—Ä,** –µ—Å–ª–∏ –ø—Ä–æ—Å–µ–¥–∞–µ—Ç \"–ó–¥–æ—Ä–æ–≤—å–µ\", –¥–æ–±–∞–≤—å—Ç–µ: \"–ü—Ä–æ—Ö–æ–∂—É –æ–±—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ —É –≤—Ä–∞—á–∞ –¥–æ –∫–æ–Ω—Ü–∞ –º–µ—Å—è—Ü–∞.\" ü©∫\n\n"
                    "‚è∞ **–î–æ –≤—Å—Ç—Ä–µ—á–∏ –∑–∞–≤—Ç—Ä–∞ –≤ —ç—Ç–æ –∂–µ –≤—Ä–µ–º—è!**",
                    
                    # –°–æ–æ–±—â–µ–Ω–∏–µ 5 (–±—É–¥–µ—Ç –∫–∞—Ä—Ç–∏–Ω–∫–∞ 2)
                    ""  # –ü—É—Å—Ç–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –¥–ª—è –∫–∞—Ä—Ç–∏–Ω–∫–∏
                ]
                
                day2_images = [
                    "https://ibb.co/svHv7mrc",
                    "https://ibb.co/tpt2TWst"
                ]
                
                cursor.execute(
                    """INSERT INTO course_content (day_number, messages, has_images, image_urls) 
                    VALUES (%s, %s, %s, %s)""",
                    (2, json.dumps(day2_messages, ensure_ascii=False), True, day2_images)
                )
                
                # –î–µ–Ω—å 3 - 3 —Å–æ–æ–±—â–µ–Ω–∏—è
                day3_messages = [
                    # –°–æ–æ–±—â–µ–Ω–∏–µ 1
                    "üëã **–ó–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ! –°–µ–≥–æ–¥–Ω—è ‚Äî –î–µ–Ω—å 3: –†–∞—Å—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–æ–≤!**\n\n"
                    "–ß—Ç–æ–±—ã –æ—Ç—Å–µ—è—Ç—å –Ω–∞–≤—è–∑–∞–Ω–Ω—ã–µ –∂–µ–ª–∞–Ω–∏—è, –º—ã –ø—Ä–æ–≤–µ–¥–µ–º –º–æ—â–Ω–æ–µ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ: **\"–ú–æ–π –ü–æ—Å–ª–µ–¥–Ω–∏–π –î–µ–Ω—å\".**\n\n"
                    "–°—è–¥—å—Ç–µ —É–¥–æ–±–Ω–æ, —Ä–∞—Å—Å–ª–∞–±—å—Ç–µ—Å—å. –ü—Ä–µ–¥—Å—Ç–∞–≤—å—Ç–µ: **–∑–∞–≤—Ç—Ä–∞ ‚Äî –≤–∞—à –ø–æ—Å–ª–µ–¥–Ω–∏–π –¥–µ–Ω—å.** –£ –≤–∞—Å –µ—Å—Ç—å **–≤—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ —Ä–µ—Å—É—Ä—Å—ã.**\n\n"
                    "–û–ø–∏—à–∏—Ç–µ —ç—Ç–æ—Ç –¥–µ–Ω—å –Ω–∞ –±—É–º–∞–≥–µ, –æ—Ç–≤–µ—Ç–∏–≤ –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã:\n"
                    "üî∏ **–ß–µ–º –≤—ã –µ–≥–æ –Ω–∞–ø–æ–ª–Ω–∏—Ç–µ?**\n"
                    "üî∏ **–° –∫–µ–º –∏ –∫–∞–∫ –ø—Ä–æ–≤–µ–¥–µ—Ç–µ –≤—Ä–µ–º—è?**\n"
                    "üî∏ **–ß—Ç–æ –ø—Ä–∏–æ–±—Ä–µ—Ç–µ—Ç –ø–µ—Ä–≤–æ—Å—Ç–µ–ø–µ–Ω–Ω—ã–π —Å–º—ã—Å–ª?**\n"
                    "üî∏ **–ß—Ç–æ —Ç–æ—á–Ω–æ –Ω–µ —Å—Ç–∞–Ω–µ—Ç–µ –¥–µ–ª–∞—Ç—å?**",
                    
                    # –°–æ–æ–±—â–µ–Ω–∏–µ 2
                    "‚ö°Ô∏è **–û—Å–æ–∑–Ω–∞–Ω–∏—è –∏ –í—ã–≤–æ–¥—ã**\n\n"
                    "–ü–æ—Å–ª–µ —Ç–æ–≥–æ –∫–∞–∫ –≤—ã –æ–ø–∏—à–µ—Ç–µ –¥–µ–Ω—å, –ø–æ–¥—É–º–∞–π—Ç–µ –Ω–∞–¥ —Å–≤–æ–∏–º–∏ —Å–æ–∂–∞–ª–µ–Ω–∏—è–º–∏:\n"
                    "‚ñ™Ô∏è **–û —á–µ–º –≤—ã –±—É–¥–µ—Ç–µ —Å–æ–∂–∞–ª–µ—Ç—å –≤ —Å–≤–æ–µ–π –ø—Ä–æ—à–µ–¥—à–µ–π –∂–∏–∑–Ω–∏:** –ø–æ—Å—Ç—É–ø–∫–∞—Ö, **–æ—Ç–ª–æ–∂–µ–Ω–Ω—ã—Ö –≤ –¥–æ–ª–≥–∏–π —è—â–∏–∫** –¥–µ–ª–∞—Ö, –º–µ—á—Ç–∞—Ö?\n"
                    "‚ñ™Ô∏è **–ö–∞–∫ –≤—ã –æ—Ü–µ–Ω–∏—Ç–µ –∂–∏–∑–Ω—å, –∫–æ—Ç–æ—Ä–∞—è –æ—Å—Ç–∞–ª–∞—Å—å –ø–æ–∑–∞–¥–∏?**\n\n"
                    "**–ó–∞–ø–∏—à–∏—Ç–µ –≤–∞—à–∏ –æ—Å–æ–∑–Ω–∞–Ω–∏—è.** –ß—Ç–æ –≤ –≤–∞—à–µ–π –Ω–∞—Å—Ç–æ—è—â–µ–π –∂–∏–∑–Ω–∏ **–∏–∑–∂–∏–ª–æ —Å–µ–±—è?** –ß–µ–≥–æ, –Ω–∞–æ–±–æ—Ä–æ—Ç, **–Ω–µ —Ö–≤–∞—Ç–∞–µ—Ç?** –ß—Ç–æ —Ö–æ—á–µ—Ç—Å—è –¥–æ–±–∞–≤–∏—Ç—å, —á—Ç–æ–±—ã –∂–∏–∑–Ω—å –ø—Ä–∏–Ω–æ—Å–∏–ª–∞ –±–æ–ª—å—à–µ —Ä–∞–¥–æ—Å—Ç–∏?",
                    
                    # –°–æ–æ–±—â–µ–Ω–∏–µ 3
                    "‚úÇÔ∏è **–§–∏–Ω–∞–ª—å–Ω—ã–π –û—Ç—Å–µ–≤**\n\n"
                    "–í–æ–∑—å–º–∏—Ç–µ —Å–≤–æ–π —Å–ø–∏—Å–æ–∫ –∂–µ–ª–∞–Ω–∏–π (–∏–∑ –î–Ω—è 1) –∏ –æ—Ü–µ–Ω–∏—Ç–µ –∫–∞–∂–¥–æ–µ –ø–æ —à–∫–∞–ª–µ –æ—Ç **0 –¥–æ 10 –±–∞–ª–ª–æ–≤** –ø–æ —Å—Ç–µ–ø–µ–Ω–∏ –≤–∞–∂–Ω–æ—Å—Ç–∏, –æ—Å–Ω–æ–≤—ã–≤–∞—è—Å—å –Ω–∞ –æ—Å–æ–∑–Ω–∞–Ω–∏—è—Ö —ç—Ç–æ–≥–æ –¥–Ω—è:\n"
                    "‚úñÔ∏è **0:** –ñ–µ–ª–∞–Ω–∏–µ –ø–æ–ª–Ω–æ—Å—Ç—å—é –ø–æ—Ç–µ—Ä—è–ª–æ —Å–º—ã—Å–ª.\n"
                    "‚òëÔ∏è **10:** –ë—É–¥—É —Ä–µ–∞–ª–∏–∑–æ–≤—ã–≤–∞—Ç—å —ç—Ç–æ –∂–µ–ª–∞–Ω–∏–µ –≤ –ø–µ—Ä–≤—É—é –æ—á–µ—Ä–µ–¥—å.\n\n"
                    "**–î–µ–π—Å—Ç–≤–∏–µ:**\n"
                    "üóëÔ∏è **–ñ–µ–ª–∞–Ω–∏—è, –Ω–∞–±—Ä–∞–≤—à–∏–µ 5 –±–∞–ª–ª–æ–≤ –∏ –º–µ–Ω–µ–µ,** ‚Äî —Å–º–µ–ª–æ –≤—ã—á–µ—Ä–∫–∏–≤–∞–π—Ç–µ –∏–∑ —Å–ø–∏—Å–∫–∞.\n"
                    "üåü **–ñ–µ–ª–∞–Ω–∏—è, –Ω–∞–±—Ä–∞–≤—à–∏–µ 6 –±–∞–ª–ª–æ–≤ –∏ –≤—ã—à–µ,** ‚Äî —ç—Ç–æ –≤–∞—à **–Ω–æ–≤—ã–π, –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω–Ω—ã–π —Å–ø–∏—Å–æ–∫.**\n\n"
                    "**–ü–æ–º–Ω–∏—Ç–µ:** –Ω–∞—á–∏–Ω–∞–π—Ç–µ –Ω–∞–ø–æ–ª–Ω—è—Ç—å –≤–∞—à—É –∂–∏–∑–Ω—å —Å–∞–º—ã–º –≤–∞–∂–Ω—ã–º –∏ –Ω—É–∂–Ω—ã–º –¥–ª—è –≤–∞—Å!\n\n"
                    "‚è∞ **–î–æ –≤—Å—Ç—Ä–µ—á–∏ –∑–∞–≤—Ç—Ä–∞ –≤ —ç—Ç–æ –∂–µ –≤—Ä–µ–º—è!**"
                ]
                
                cursor.execute(
                    "INSERT INTO course_content (day_number, messages) VALUES (%s, %s)",
                    (3, json.dumps(day3_messages, ensure_ascii=False))
                )
                
                # –î–µ–Ω—å 4 - 3 —Å–æ–æ–±—â–µ–Ω–∏—è
                day4_messages = [
                    # –°–æ–æ–±—â–µ–Ω–∏–µ 1
                    "üëã **–ó–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ! –°–µ–≥–æ–¥–Ω—è ‚Äî –î–µ–Ω—å 4: –≠–Ω–µ—Ä–≥–∏—è –ú–µ—á—Ç—ã!**\n\n"
                    "–ü–æ—Å–ª–µ —Å–µ—Ä—å–µ–∑–Ω–æ–≥–æ –æ—Ç—Å–µ–≤–∞ –∂–µ–ª–∞–Ω–∏–π –Ω–∞–º –Ω—É–∂–Ω–∞ **–º–æ—â–Ω–∞—è –ø–æ–¥–ø–∏—Ç–∫–∞.** –°–∞–º—ã–π –±—ã—Å—Ç—Ä—ã–π —Å–ø–æ—Å–æ–± —ç—Ç–æ —Å–¥–µ–ª–∞—Ç—å ‚Äî —Å–æ–∑–¥–∞—Ç—å **–ö–æ–ª–ª–∞–∂ –ú–µ—á—Ç—ã.**\n\n"
                    "–ö–æ–ª–ª–∞–∂ ‚Äî —ç—Ç–æ **–≤–∏–∑—É–∞–ª—å–Ω—ã–π —è–∫–æ—Ä—å,** –∫–æ—Ç–æ—Ä—ã–π —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ —É—Ä–æ–≤–Ω–µ –ø–æ–¥—Å–æ–∑–Ω–∞–Ω–∏—è –∏ –Ω–∞–ø–æ–º–∏–Ω–∞–µ—Ç –≤–∞–º –æ –≤–∞—à–∏—Ö **–∏—Å—Ç–∏–Ω–Ω—ã—Ö –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞—Ö** –∫–∞–∂–¥—ã–π –¥–µ–Ω—å.\n\n"
                    "–ú—ã —Å–æ–∑–¥–∞–¥–∏–º –µ–≥–æ, –æ–ø–∏—Ä–∞—è—Å—å –Ω–∞ **–æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω–Ω—ã–π —Å–ø–∏—Å–æ–∫ –∂–µ–ª–∞–Ω–∏–π** –∏–∑ –î–Ω—è 3.",
                    
                    # –°–æ–æ–±—â–µ–Ω–∏–µ 2
                    "‚úÇÔ∏è **–ü—Ä–∞–∫—Ç–∏–∫–∞: –°–æ–∑–¥–∞–µ–º –¶–ò–§–†–û–í–û–ô –ö–æ–ª–ª–∞–∂**\n\n"
                    "üî∏ **–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã:** –í—ã –º–æ–∂–µ—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ª—é–±—É—é –ø—Ä–æ–≥—Ä–∞–º–º—É: **PowerPoint, Canva,** –∏–ª–∏ **–ø—Ä–æ—Å—Ç–æ–π –≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–π —Ä–µ–¥–∞–∫—Ç–æ—Ä, —Ç–µ–ª–µ—Ñ–æ–Ω.**\n"
                    "üî∏ **–ü–æ–∏—Å–∫ –∫–∞—Ä—Ç–∏–Ω–æ–∫:** –ò—â–∏—Ç–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤ **–ò–Ω—Ç–µ—Ä–Ω–µ—Ç–µ**, –∫–æ—Ç–æ—Ä—ã–µ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ **—Ç–æ—á–Ω–æ –æ—Ç—Ä–∞–∂–∞—é—Ç** –≤–∞—à–µ –∂–µ–ª–∞–Ω–∏–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, \"–æ—â—É—â–µ–Ω–∏–µ –ø–æ–∫–æ—è\", \"—É—Å–ø–µ—à–Ω—ã–π –±–∏–∑–Ω–µ—Å\").\n"
                    "üî∏ **–õ–∏—á–Ω—ã–π –Ø–∫–æ—Ä—å (–í–∞–∂–Ω–æ!):**\n"
                    "–û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –¥–æ–±–∞–≤—å—Ç–µ —Å–≤–æ–µ **—Ñ–æ—Ç–æ, –∫–æ—Ç–æ—Ä–æ–µ –≤–∞–º –æ—á–µ–Ω—å –Ω—Ä–∞–≤–∏—Ç—Å—è** –∏ –≥–¥–µ –≤—ã —á—É–≤—Å—Ç–≤—É–µ—Ç–µ —Å–µ–±—è —Å–∏–ª—å–Ω—ã–º/—Å—á–∞—Å—Ç–ª–∏–≤—ã–º.\n"
                    "üî∏ **–ò–ª–∏ –¥–æ–±–∞–≤—å—Ç–µ —Ñ–æ—Ç–æ —á–µ–ª–æ–≤–µ–∫–∞-–ø—Ä–∏–º–µ—Ä–∞** (Role model), –æ—Ç –∫–æ—Ç–æ—Ä–æ–≥–æ –∏—Å—Ö–æ–¥–∏—Ç –Ω—É–∂–Ω–∞—è —ç–Ω–µ—Ä–≥–∏—è –∏ –∫–æ—Ç–æ—Ä—ã–π —É–∂–µ –¥–æ—Å—Ç–∏–≥ –∂–µ–ª–∞–µ–º–æ–≥–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞.\n\n"
                    "**–í–∞–∂–Ω–æ:** –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –¥–æ–ª–∂–Ω–æ –≤—ã–∑—ã–≤–∞—Ç—å —É –≤–∞—Å **—ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –æ—Ç–∫–ª–∏–∫,** –∞ –Ω–µ –ø—Ä–æ—Å—Ç–æ –±—ã—Ç—å –∫—Ä–∞—Å–∏–≤—ã–º.",
                    
                    # –°–æ–æ–±—â–µ–Ω–∏–µ 3
                    "üñºÔ∏è **–ì–¥–µ —Ä–∞–∑–º–µ—Å—Ç–∏—Ç—å?**\n\n"
                    "–ü–æ—Å—Ç–∞–≤—å—Ç–µ –≥–æ—Ç–æ–≤—ã–π –∫–æ–ª–ª–∞–∂ –Ω–∞ **–∑–∞—Å—Ç–∞–≤–∫—É** —Ç–µ–ª–µ—Ñ–æ–Ω–∞ –∏–ª–∏ —Ä–∞–±–æ—á–µ–≥–æ —Å—Ç–æ–ª–∞, —á—Ç–æ–±—ã –≤–∏–¥–µ—Ç—å –µ–≥–æ **–º–∏–Ω–∏–º—É–º –¥–≤–∞ —Ä–∞–∑–∞ –≤ –¥–µ–Ω—å.**\n\n"
                    "**–¶–µ–ª—å —ç—Ç–æ–≥–æ –¥–Ω—è:** —Å–æ–∑–¥–∞—Ç—å –≤–¥–æ—Ö–Ω–æ–≤–ª—è—é—â–∏–π –æ–±—Ä–∞–∑ –≤–∞—à–µ–≥–æ **–∂–µ–ª–∞–µ–º–æ–≥–æ –±—É–¥—É—â–µ–≥–æ,** —á—Ç–æ–±—ã –ø–æ–≤—ã—Å–∏—Ç—å —ç–Ω–µ—Ä–≥–∏—é –ø–µ—Ä–µ–¥ –ø–µ—Ä–µ—Ö–æ–¥–æ–º –∫ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–º—É –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—é.\n\n"
                    "**–ü—Ä–∏ –∂–µ–ª–∞–Ω–∏–∏ –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å –∫–æ–ª–ª–∞–∂ –Ω–∞ –±—É–º–∞–≥–µ.**\n\n"
                    "–ó–∞–≤—Ç—Ä–∞ –º—ã –≤–æ–∑—å–º–µ–º —Å–∞–º—ã–µ –≤–∞–∂–Ω—ã–µ –∂–µ–ª–∞–Ω–∏—è –∏–∑ –∫–æ–ª–ª–∞–∂–∞ –∏ –ø—Ä–µ–≤—Ä–∞—Ç–∏–º –∏—Ö –≤ **—Ü–µ–ª–∏!**\n\n"
                    "‚è∞ **–î–æ –≤—Å—Ç—Ä–µ—á–∏ –∑–∞–≤—Ç—Ä–∞ –≤ —ç—Ç–æ –∂–µ –≤—Ä–µ–º—è!**"
                ]
                
                cursor.execute(
                    "INSERT INTO course_content (day_number, messages) VALUES (%s, %s)",
                    (4, json.dumps(day4_messages, ensure_ascii=False))
                )
                
                # –î–µ–Ω—å 5 - 3 —Å–æ–æ–±—â–µ–Ω–∏—è
                day5_messages = [
                    # –°–æ–æ–±—â–µ–Ω–∏–µ 1
                    "üëã **–ó–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ! –°–µ–≥–æ–¥–Ω—è ‚Äî –î–µ–Ω—å 5: –û—Ç –ú–µ—á—Ç—ã –∫ –¶–µ–ª–∏!**\n\n"
                    "–ú—ã –ø–µ—Ä–µ—Ö–æ–¥–∏–º –æ—Ç —Ç–≤–æ—Ä—á–µ—Å–∫–æ–≥–æ –≤–¥–æ—Ö–Ω–æ–≤–µ–Ω–∏—è (–∫–æ–ª–ª–∞–∂) –∫ **—Ä–∞—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–º—É –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—é.**\n\n"
                    "–°–∞–º–æ–µ –≤—Ä–µ–º—è –ø—Ä–µ–≤—Ä–∞—Ç–∏—Ç—å –Ω–∞—à–∏ —Å–∞–º—ã–µ –≤–∞–∂–Ω—ã–µ –∂–µ–ª–∞–Ω–∏—è –≤ **–∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ, –∏–∑–º–µ—Ä–∏–º—ã–µ —Ü–µ–ª–∏.**\n\n"
                    "–î–ª—è —ç—Ç–æ–≥–æ –º—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç ‚Äî **SMART.** –ö–∞–∂–¥–∞—è –±—É–∫–≤–∞ –æ–±–æ–∑–Ω–∞—á–∞–µ—Ç –∫—Ä–∏—Ç–µ—Ä–∏–π, –∫–æ—Ç–æ—Ä–æ–º—É –¥–æ–ª–∂–Ω–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–æ–≤–∞—Ç—å –≤–∞—à–∞ —Ü–µ–ª—å: üëá",
                    
                    # –°–æ–æ–±—â–µ–Ω–∏–µ 2
                    "üìù **–ö—Ä–∏—Ç–µ—Ä–∏–∏ SMART**\n\n"
                    "‚ö°Ô∏è **S (Specific/–ö–æ–Ω–∫—Ä–µ—Ç–Ω–∞—è):** –ß—Ç–æ –∏–º–µ–Ω–Ω–æ –≤—ã —Ö–æ—Ç–∏—Ç–µ? (–ù–ï \"–•–æ—á—É –±—ã—Ç—å –±–æ–≥–∞—Ç—ã–º\", –∞ \"–•–æ—á—É $N –¥–µ–Ω–µ–≥ –Ω–∞ —Å—á–µ—Ç—É\").\n"
                    "‚ö°Ô∏è **M (Measurable/–ò–∑–º–µ—Ä–∏–º–∞—è):** –ö–∞–∫ –≤—ã –ø–æ–π–º–µ—Ç–µ, —á—Ç–æ —Ü–µ–ª—å –¥–æ—Å—Ç–∏–≥–Ω—É—Ç–∞? (–í —Ü–∏—Ñ—Ä–∞—Ö, —Å—Ä–æ–∫–∞—Ö, —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞—Ö).\n"
                    "‚ö°Ô∏è **A (Achievable/–î–æ—Å—Ç–∏–∂–∏–º–∞—è):** –†–µ–∞–ª–∏—Å—Ç–∏—á–Ω–∞ –ª–∏ –æ–Ω–∞ –≤ –¥–∞–Ω–Ω—ã—Ö —É—Å–ª–æ–≤–∏—è—Ö –∏ —Ä–µ—Å—É—Ä—Å–∞—Ö? (–î–æ–ª–∂–Ω–∞ –±—ã—Ç—å —Å–ª–æ–∂–Ω–æ–π, –Ω–æ –Ω–µ —Ñ–∞–Ω—Ç–∞—Å—Ç–∏—á–µ—Å–∫–æ–π).\n"
                    "‚ö°Ô∏è **R (Relevant/–ó–Ω–∞—á–∏–º–∞—è):** –í–∞—à–∞ –ª–∏ —ç—Ç–æ —Ü–µ–ª—å? –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –ª–∏ –æ–Ω–∞ –≤–∞—à–∏–º –∂–∏–∑–Ω–µ–Ω–Ω—ã–º —Ü–µ–Ω–Ω–æ—Å—Ç—è–º?\n"
                    "‚ö°Ô∏è **T (Time-bound/–û–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–∞—è –≤–æ –≤—Ä–µ–º–µ–Ω–∏):** –ö –∫–∞–∫–æ–º—É –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–º—É —Å—Ä–æ–∫—É —ç—Ç–æ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å —Å–¥–µ–ª–∞–Ω–æ? (–î–∞—Ç–∞/–º–µ—Å—è—Ü/–≥–æ–¥).\n\n"
                    "**–í–∞–∂–Ω–æ!** –¶–µ–ª—å –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å —Å—Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∞–Ω–∞ **–≤ —É—Ç–≤–µ—Ä–¥–∏—Ç–µ–ª—å–Ω–æ–π —Ñ–æ—Ä–º–µ** (–±–µ–∑ —á–∞—Å—Ç–∏—Ü—ã \"–ù–ï\") –∏ **–æ—Ç –ø–µ—Ä–≤–æ–≥–æ –ª–∏—Ü–∞** (\"–Ø –ø–æ–ª—É—á–∞—é...\").",
                    
                    # –°–æ–æ–±—â–µ–Ω–∏–µ 3
                    "‚úÖ **–ó–∞–¥–∞–Ω–∏–µ –î–Ω—è: –ü–µ—Ä–µ–≤–æ–¥ –≤ –¶–µ–ª–∏**\n\n"
                    "‚ñ™Ô∏è **–í—ã–±–µ—Ä–∏—Ç–µ 3-5 —Å–∞–º—ã—Ö –≤–∞–∂–Ω—ã—Ö** –∂–µ–ª–∞–Ω–∏–π –∏–∑ –≤–∞—à–µ–≥–æ –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ —Å–ø–∏—Å–∫–∞ (–∏–ª–∏ –ø—Ä—è–º–æ –∏–∑ –∫–æ–ª–ª–∞–∂–∞).\n"
                    "‚ñ™Ô∏è **–ü–µ—Ä–µ–ø–∏—à–∏—Ç–µ –∏—Ö,** –∏—Å–ø–æ–ª—å–∑—É—è –≤—Å–µ **5 –∫—Ä–∏—Ç–µ—Ä–∏–µ–≤ SMART.**\n"
                    "‚ñ™Ô∏è **–ó–∞—Ñ–∏–∫—Å–∏—Ä—É–π—Ç–µ** –∏—Ö –Ω–∞ –æ—Ç–¥–µ–ª—å–Ω–æ–º –ª–∏—Å—Ç–µ –±—É–º–∞–≥–∏.\n\n"
                    "**–ü—Ä–∏–º–µ—Ä:** –ù–ï \"–ù–∞—á–∞—Ç—å –±–æ–ª—å—à–µ –∑–∞–Ω–∏–º–∞—Ç—å—Å—è —Å–ø–æ—Ä—Ç–æ–º\", –∞ **\"–Ø —Ö–æ–∂—É –≤ –±–∞—Å—Å–µ–π–Ω –¥–≤–∞ —Ä–∞–∑–∞ –≤ –Ω–µ–¥–µ–ª—é (–ü–Ω, –ß—Ç) –≤ —Ç–µ—á–µ–Ω–∏–µ 6 –º–µ—Å—è—Ü–µ–≤, –Ω–∞—á–∏–Ω–∞—è —Å 1 –¥–µ–∫–∞–±—Ä—è 2025 –≥–æ–¥–∞.\"** üèä‚Äç‚ôÄÔ∏è\n\n"
                    "–≠—Ç–æ ‚Äî –≤–∞—à **—Ñ—É–Ω–¥–∞–º–µ–Ω—Ç** –¥–ª—è –∑–∞–≤—Ç—Ä–∞—à–Ω–µ–≥–æ –ø–ª–∞–Ω–∞ –¥–µ–π—Å—Ç–≤–∏–π!\n\n"
                    "‚è∞ **–î–æ –≤—Å—Ç—Ä–µ—á–∏ –∑–∞–≤—Ç—Ä–∞ –≤ —ç—Ç–æ –∂–µ –≤—Ä–µ–º—è!**"
                ]
                
                cursor.execute(
                    "INSERT INTO course_content (day_number, messages) VALUES (%s, %s)",
                    (5, json.dumps(day5_messages, ensure_ascii=False))
                )
                
                # –î–µ–Ω—å 6 - 3 —Å–æ–æ–±—â–µ–Ω–∏—è
                day6_messages = [
                    # –°–æ–æ–±—â–µ–Ω–∏–µ 1
                    "üëã **–ó–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ! –°–µ–≥–æ–¥–Ω—è ‚Äî –î–µ–Ω—å 6: –î–µ–π—Å—Ç–≤–∏–µ –∏ –û–±–µ—Å–ø–µ—á–µ–Ω–∏–µ!**\n\n"
                    "–°–∞–º–æ–µ –≤—Ä–µ–º—è —Å–æ—Å—Ç–∞–≤–∏—Ç—å **–∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π, —Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω—ã–π –ø–ª–∞–Ω** –¥–ª—è –≤–∞—à–∏—Ö –≥–ª–∞–≤–Ω—ã—Ö **SMART-—Ü–µ–ª–µ–π.** –¶–µ–ª—å –±–µ–∑ —Ä–µ—Å—É—Ä—Å–æ–≤ ‚Äî —ç—Ç–æ –º–µ—á—Ç–∞. –¶–µ–ª—å —Å —Ä–µ—Å—É—Ä—Å–∞–º–∏ –∏ —à–∞–≥–∞–º–∏ ‚Äî —ç—Ç–æ –ø–ª–∞–Ω.\n\n"
                    "–ú—ã –æ–±—ä–µ–¥–∏–Ω–∏–º –¥–≤–∞ —ç–ª–µ–º–µ–Ω—Ç–∞:\n"
                    "‚òëÔ∏è **–î–µ–∫–æ–º–ø–æ–∑–∏—Ü–∏—è:** –†–∞–∑–±–∏—Ç—å —Ü–µ–ª—å –Ω–∞ –º–µ–ª–∫–∏–µ —à–∞–≥–∏.\n"
                    "‚òëÔ∏è **–û–±–µ—Å–ø–µ—á–µ–Ω–∏–µ:** –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å, —á—Ç–æ –Ω—É–∂–Ω–æ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —à–∞–≥–∞.\n\n"
                    "–ù–∞–º –Ω—É–∂–µ–Ω **–ü–ª–∞–Ω –ü–µ—Ä–≤—ã—Ö 72 –ß–∞—Å–æ–≤** –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –Ω–∞–º–µ—Ä–µ–Ω–∏—è –∏ –ø–æ–ø—É—Ç–Ω–æ–≥–æ –≤–µ—Ç—Ä–∞.\n\n"
                    "**–ü—Ä–∞–≤–∏–ª–æ 72 —á–∞—Å–æ–≤ –≥–ª–∞—Å–∏—Ç:** –µ—Å–ª–∏ –≤—ã –Ω–µ –ø—Ä–µ–¥–ø—Ä–∏–Ω—è–ª–∏ –ø–µ—Ä–≤—ã–π —à–∞–≥ –≤ —Ç–µ—á–µ–Ω–∏–µ 72 —á–∞—Å–æ–≤ –ø–æ—Å–ª–µ –ø—Ä–∏–Ω—è—Ç–∏—è —Ä–µ—à–µ–Ω–∏—è, –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è —Ü–µ–ª–∏ –ø–∞–¥–∞–µ—Ç –ø–æ—á—Ç–∏ –¥–æ –Ω—É–ª—è. üìâ",
                    
                    # –°–æ–æ–±—â–µ–Ω–∏–µ 2
                    "üìù **–ó–∞–¥–∞–Ω–∏–µ –î–Ω—è: –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ü–ª–∞–Ω**\n\n"
                    "‚úîÔ∏è **–í—ã–±–µ—Ä–∏—Ç–µ –≥–ª–∞–≤–Ω—ã–µ SMART-—Ü–µ–ª–∏** –∏–∑ –î–Ω—è 5.\n"
                    "‚úîÔ∏è **–†–∞–∑–±–µ–π—Ç–µ –∏—Ö –Ω–∞ –º–µ–ª—å—á–∞–π—à–∏–µ, –ø—Ä–æ—Å—Ç—ã–µ —à–∞–≥–∏.** –ü–æ–º–Ω–∏—Ç–µ: –ø–µ—Ä–≤—ã–π —à–∞–≥ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —Ç–∞–∫–∏–º, —á—Ç–æ–±—ã –µ–≥–æ –±—ã–ª–æ **–Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ –Ω–µ —Å–¥–µ–ª–∞—Ç—å.**\n"
                    "‚úîÔ∏è **–î–ª—è –∫–∞–∂–¥–æ–≥–æ —à–∞–≥–∞ –ø—Ä–æ–ø–∏—à–∏—Ç–µ,** –∫–∞–∫–æ–π **—Ä–µ—Å—É—Ä—Å** –≤–∞–º –ø–æ–Ω–∞–¥–æ–±–∏—Ç—Å—è (–§–∏–Ω–∞–Ω—Å—ã, –í—Ä–µ–º—è, –ß–µ–ª–æ–≤–µ—á–µ—Å–∫–∏–π —Ñ–∞–∫—Ç–æ—Ä, –≠–Ω–µ—Ä–≥–∏—è).\n\n"
                    "**–ü–†–ò–ú–ï–† (–¶–µ–ª—å: –ù–∞—á–∞—Ç—å –±–µ–≥–∞—Ç—å 3 —Ä–∞–∑–∞ –≤ –Ω–µ–¥–µ–ª—é):**\n"
                    "‚ñ™Ô∏è **–®–∞–≥ 1:** –ö—É–ø–∏—Ç—å —É–¥–æ–±–Ω—ã–µ –∫—Ä–æ—Å—Å–æ–≤–∫–∏. **–†–µ—Å—É—Ä—Å:** –î–µ–Ω—å–≥–∏.\n"
                    "‚ñ™Ô∏è **–®–∞–≥ 2:** –ù–∞–π—Ç–∏ –≤ –ò–Ω—Ç–µ—Ä–Ω–µ—Ç–µ –º–∞—Ä—à—Ä—É—Ç –¥–ª—è 20-–º–∏–Ω—É—Ç–Ω–æ–π –ø—Ä–æ–±–µ–∂–∫–∏. **–†–µ—Å—É—Ä—Å:** –í—Ä–µ–º—è (15 –º–∏–Ω—É—Ç).\n"
                    "‚ñ™Ô∏è **–®–∞–≥ 3:** –í—ã–π—Ç–∏ –Ω–∞ —É–ª–∏—Ü—É –∏ –ø—Ä–æ–π—Ç–∏ —ç—Ç–æ—Ç –º–∞—Ä—à—Ä—É—Ç –±—ã—Å—Ç—Ä—ã–º —à–∞–≥–æ–º. **–†–µ—Å—É—Ä—Å:** –≠–Ω–µ—Ä–≥–µ—Ç–∏—á–µ—Å–∫–∏–π (–Ω–∞—á–∞–ª—å–Ω—ã–π –∏–º–ø—É–ª—å—Å).",
                    
                    # –°–æ–æ–±—â–µ–Ω–∏–µ 3
                    "‚úÖ **–í–∞—à –§–∏–Ω–∞–ª—å–Ω—ã–π –ü–ª–∞–Ω**\n\n"
                    "–°–æ—Å—Ç–∞–≤—å—Ç–µ —á–µ—Ç–∫—É—é –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∏–∑ **3-—Ö —à–∞–≥–æ–≤ –Ω–∞ –±–ª–∏–∂–∞–π—à–∏–µ 72 —á–∞—Å–∞,** –≤–∫–ª—é—á–∞—è –Ω—É–∂–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã.\n\n"
                    "**–°–¥–µ–ª–∞–π—Ç–µ –®–∞–≥ 1 —Å—Ä–∞–∑—É –ø–æ—Å–ª–µ –ø—Ä–æ—á—Ç–µ–Ω–∏—è —ç—Ç–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è!** üöÄ –ù–µ –æ—Ç–∫–ª–∞–¥—ã–≤–∞–π—Ç–µ —Å—Ç–∞—Ä—Ç, —ç—Ç–æ —Å–æ–∑–¥–∞–µ—Ç **–∏–Ω–µ—Ä—Ü–∏—é.**\n\n"
                    "–≠—Ç–æ —Å–∞–º—ã–π –≤–∞–∂–Ω—ã–π –¥–µ–Ω—å –∫—É—Ä—Å–∞. –í—ã –≥–æ—Ç–æ–≤—ã –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç—å –æ—Ç –ø–ª–∞–Ω–æ–≤ –∫ —Ä–µ–∞–ª—å–Ω–æ—Å—Ç–∏!\n\n"
                    "‚è∞ **–î–æ –≤—Å—Ç—Ä–µ—á–∏ –∑–∞–≤—Ç—Ä–∞ –Ω–∞ —Ñ–∏–Ω–∞–ª—å–Ω–æ–º –¥–Ω–µ!**"
                ]
                
                cursor.execute(
                    "INSERT INTO course_content (day_number, messages) VALUES (%s, %s)",
                    (6, json.dumps(day6_messages, ensure_ascii=False))
                )
                
                # –î–µ–Ω—å 7 - 3 —Å–æ–æ–±—â–µ–Ω–∏—è
                day7_messages = [
                    # –°–æ–æ–±—â–µ–Ω–∏–µ 1
                    "üëã **–ó–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ! –°–µ–≥–æ–¥–Ω—è ‚Äî –î–µ–Ω—å 7: –§–∏–Ω–∞–ª –∏ –û–±—è–∑–∞—Ç–µ–ª—å—Å—Ç–≤–æ!**\n\n"
                    "–í—ã –ø—Ä–æ—à–ª–∏ –æ–≥—Ä–æ–º–Ω—ã–π –ø—É—Ç—å:\n"
                    "‚òëÔ∏è **–†–∞–∑–±—É–¥–∏–ª–∏ –ú–µ—á—Ç–∞—Ç–µ–ª—è** (–î–µ–Ω—å 1).\n"
                    "‚òëÔ∏è **–ù–∞–≤–µ–ª–∏ –ø–æ—Ä—è–¥–æ–∫** –≤ –∂–∏–∑–Ω–∏ (–î–µ–Ω—å 2).\n"
                    "‚òëÔ∏è **–û—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–ª–∏ –ª–∏—à–Ω–µ–µ** (–î–µ–Ω—å 3).\n"
                    "‚òëÔ∏è **–í–¥–æ—Ö–Ω–æ–≤–∏–ª–∏—Å—å –∫–æ–ª–ª–∞–∂–µ–º** (–î–µ–Ω—å 4).\n"
                    "‚òëÔ∏è **–°—Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∞–ª–∏ SMART-—Ü–µ–ª–∏** (–î–µ–Ω—å 5).\n"
                    "‚òëÔ∏è **–°–æ–∑–¥–∞–ª–∏ –ü–ª–∞–Ω –î–µ–π—Å—Ç–≤–∏–π** (–î–µ–Ω—å 6).\n\n"
                    "–¢–µ–ø–µ—Ä—å, –∫–æ–≥–¥–∞ –ø–ª–∞–Ω –≥–æ—Ç–æ–≤, –Ω–∞–º –Ω—É–∂–Ω–∞ **–ú–ï–ù–¢–ê–õ–¨–ù–ê–Ø –ó–ê–©–ò–¢–ê** ‚Äî –æ–ø–æ—Ä–∞ –ø—Ä–æ—Ç–∏–≤ —Å–æ–º–Ω–µ–Ω–∏–π –∏ –æ—Ç–∫–∞—Ç–∞ –Ω–∞–∑–∞–¥. üõ°Ô∏è",
                    
                    # –°–æ–æ–±—â–µ–Ω–∏–µ 2
                    "üìù **–°–æ–∑–¥–∞–µ–º –ú–∞–Ω—Ç—Ä—É-–ó–∞—â–∏—Ç—É**\n\n"
                    "–ù–∞ –ø—É—Ç–∏ –∫ —Ü–µ–ª–∏ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –±—É–¥—É—Ç —Ç—Ä—É–¥–Ω–æ—Å—Ç–∏ –∏ –º–æ–º–µ–Ω—Ç—ã, –∫–æ–≥–¥–∞ –∑–∞—Ö–æ—á–µ—Ç—Å—è –≤—Å–µ –±—Ä–æ—Å–∏—Ç—å. –í —ç—Ç–æ—Ç –º–æ–º–µ–Ω—Ç –≤–∞–º –ø–æ–Ω–∞–¥–æ–±–∏—Ç—Å—è **—Å–∏–ª—å–Ω–∞—è —Ñ—Ä–∞–∑–∞,** –≤–æ–∑–≤—Ä–∞—â–∞—é—â–∞—è –∫ –≤–∞—à–µ–º—É –æ–±—è–∑–∞—Ç–µ–ª—å—Å—Ç–≤—É.\n\n"
                    "–í—ã–±–µ—Ä–∏—Ç–µ **2-3 —Å–∞–º—ã–µ –≤–∞–∂–Ω—ã–µ —Ü–µ–ª–∏** –∏ —Å–æ–∑–¥–∞–π—Ç–µ –¥–ª—è –Ω–∏—Ö **–ª–∏—á–Ω—É—é –∞—Ñ—Ñ–∏—Ä–º–∞—Ü–∏—é/–º–∞–Ω—Ç—Ä—É:**\n"
                    "‚ñ™Ô∏è **–û–Ω–∞ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –∫–æ—Ä–æ—Ç–∫–æ–π –∏ —É—Ç–≤–µ—Ä–¥–∏—Ç–µ–ª—å–Ω–æ–π** (\"–Ø –º–æ–≥—É\", \"–Ø –¥–µ–ª–∞—é\").\n"
                    "‚ñ™Ô∏è **–û–Ω–∞ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –≤ –Ω–∞—Å—Ç–æ—è—â–µ–º –≤—Ä–µ–º–µ–Ω–∏** (\"–Ø —É–≤–µ—Ä–µ–Ω–Ω–æ –∏–¥—É –∫ —Å–≤–æ–µ–π —Ü–µ–ª–∏\").\n"
                    "‚ñ™Ô∏è **–û–Ω–∞ –¥–æ–ª–∂–Ω–∞ –≤—ã–∑—ã–≤–∞—Ç—å —á—É–≤—Å—Ç–≤–æ —Å–∏–ª—ã.**\n\n"
                    "**–ü–†–ò–ú–ï–†–´:**\n"
                    "‚ú® **–î–ª—è —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç–∏:** \"–ú–æ—è —ç–Ω–µ—Ä–≥–∏—è —Ä–∞—Å—Ç–µ—Ç –∫–∞–∂–¥—ã–π –¥–µ–Ω—å, —è –ª–µ–≥–∫–æ –ø—Ä–µ–æ–¥–æ–ª–µ–≤–∞—é –ø—Ä–µ–ø—è—Ç—Å—Ç–≤–∏—è.\"\n"
                    "üöÄ **–î–ª—è –¥–µ–π—Å—Ç–≤–∏—è:** \"–Ø —É–≤–µ—Ä–µ–Ω–Ω–æ –∏–¥—É –∫ —Å–≤–æ–µ–π —Ü–µ–ª–∏, –∫–∞–∂–¥—ã–π –¥–µ–Ω—å –ø—Ä–∏–±–ª–∏–∂–∞—è –µ–µ.\"\n"
                    "üíñ **–î–ª—è —Ü–µ–Ω–Ω–æ—Å—Ç–∏:** \"–Ø –¥–æ—Å—Ç–æ–π–Ω–∞ –±–æ–ª—å—à–∏—Ö —Ü–µ–ª–µ–π, –∏ —Ä–µ—Å—É—Ä—Å—ã –ø—Ä–∏—Ö–æ–¥—è—Ç –∫–æ –º–Ω–µ –ª–µ–≥–∫–æ –∏ —Å–≤–æ–µ–≤—Ä–µ–º–µ–Ω–Ω–æ.\"\n\n"
                    "**–ó–∞–¥–∞–Ω–∏–µ:** –ó–∞–ø–∏—à–∏—Ç–µ –≤–∞—à—É –º–∞–Ω—Ç—Ä—É –∏ **–ø—Ä–æ–∏–∑–Ω–µ—Å–∏—Ç–µ –µ–µ —Ç—Ä–∏–∂–¥—ã –ø—Ä—è–º–æ —Å–µ–π—á–∞—Å,** –≥–ª—è–¥—è –Ω–∞ —Å–≤–æ–π –∫–æ–ª–ª–∞–∂.",
                    
                    # –°–æ–æ–±—â–µ–Ω–∏–µ 3
                    "‚úçÔ∏è **–†–∏—Ç—É–∞–ª –õ–∏—á–Ω–æ–≥–æ –û–±—è–∑–∞—Ç–µ–ª—å—Å—Ç–≤–∞**\n\n"
                    "–í–∞—à –ø–ª–∞–Ω —Ç–µ–ø–µ—Ä—å –Ω–µ –ø—Ä–æ—Å—Ç–æ —Å–ø–∏—Å–æ–∫, —ç—Ç–æ **–∫–æ–Ω—Ç—Ä–∞–∫—Ç —Å —Å–∞–º–∏–º —Å–æ–±–æ–π.** –ü—Ä–æ–≤–µ–¥–∏—Ç–µ —Å–∏–º–≤–æ–ª–∏—á–µ—Å–∫–∏–π —Ä–∏—Ç—É–∞–ª:\n"
                    "‚ö°Ô∏è **–í–æ–∑—å–º–∏—Ç–µ** —Å–≤–æ–π **–ü–ª–∞–Ω –î–µ–π—Å—Ç–≤–∏–π** (–î–µ–Ω—å 6).\n"
                    "‚ö°Ô∏è **–ü—Ä–æ—á–∏—Ç–∞–π—Ç–µ** –µ–≥–æ –≤—Å–ª—É—Ö.\n"
                    "‚ö°Ô∏è **–ü–æ–ª–æ–∂–∏—Ç–µ —Ä—É–∫—É –Ω–∞ —Å–µ—Ä–¥—Ü–µ** –∏ **—Ç–æ—Ä–∂–µ—Å—Ç–≤–µ–Ω–Ω–æ** –ø—Ä–æ–∏–∑–Ω–µ—Å–∏—Ç–µ: **\"–Ø –±–µ—Ä—É –Ω–∞ —Å–µ–±—è –æ–±—è–∑–∞—Ç–µ–ª—å—Å—Ç–≤–æ –¥–æ–≤–µ—Å—Ç–∏ —ç—Ç–æ—Ç –ø–ª–∞–Ω –¥–æ –∫–æ–Ω—Ü–∞!\"**\n\n"
                    "**–í–∞–∂–Ω–æ:** –ö—É—Ä—Å –æ–∫–æ–Ω—á–µ–Ω, –Ω–æ **–≤–∞—à–µ –ø—É—Ç–µ—à–µ—Å—Ç–≤–∏–µ —Ç–æ–ª—å–∫–æ –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è!** –ü—Ä–æ–¥–æ–ª–∂–∞–π—Ç–µ —Å–æ–≤–µ—Ä—à–∞—Ç—å –®–∞–≥ 1, –®–∞–≥ 2 –∏ –®–∞–≥ 3, —Å–æ–∑–¥–∞–≤–∞—è –∏–Ω–µ—Ä—Ü–∏—é.\n\n"
                    "–°–ø–∞—Å–∏–±–æ, —á—Ç–æ –≤—ã–±—Ä–∞–ª–∏ **\"–ü—É—Ç—å –∫ –º–µ—á—Ç–µ\".** –Ø –≤–µ—Ä—é –≤ –≤–∞—Å! –£–¥–∞—á–∏ –Ω–∞ –ø—É—Ç–∏ –∫ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –≤–∞—à–∏—Ö —Ü–µ–ª–µ–π! üöÄ"
                ]
                
                cursor.execute(
                    "INSERT INTO course_content (day_number, messages) VALUES (%s, %s)",
                    (7, json.dumps(day7_messages, ensure_ascii=False))
                )
                
                conn.commit()
                logger.info("‚úÖ Course content initialized with proper structure")
                
        except Exception as e:
            logger.error(f"‚ùå Error initializing course content: {e}")
            conn.rollback()
        finally:
            conn.close()

    def get_or_create_user(self, user_id: int, username: str, 
                          first_name: str, last_name: str) -> bool:
        """–°–æ–∑–¥–∞–µ—Ç –∏–ª–∏ –ø–æ–ª—É—á–∞–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è"""
        conn = self.get_connection()
        cursor = conn.cursor()
        
        try:
            username = username or ""
            first_name = first_name or "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å"
            last_name = last_name or ""
            
            cursor.execute('''
                INSERT INTO users (user_id, username, first_name, last_name, registered_date)
                VALUES (%s, %s, %s, %s, CURRENT_TIMESTAMP)
                ON CONFLICT (user_id) DO NOTHING
            ''', (user_id, username, first_name, last_name))
            
            conn.commit()
            return True
        except Exception as e:
            logging.error(f"‚ùå Error creating user: {e}")
            return False
        finally:
            conn.close()

    def create_course_purchase(self, user_id, payment_method='paypal'):
        """–°–æ–∑–¥–∞–µ—Ç –∑–∞–ø–∏—Å—å –æ –ø–æ–∫—É–ø–∫–µ –∫—É—Ä—Å–∞"""
        conn = self.get_connection()
        if conn is None:
            return False
        
        cursor = conn.cursor()
        try:
            cursor.execute(
                '''
                INSERT INTO course_purchases (user_id, payment_method)
                VALUES (%s, %s)
                ''',
                (user_id, payment_method)
            )
            
            # –°–æ–∑–¥–∞–µ–º –∑–∞–ø–∏—Å—å –æ –ø—Ä–æ–≥—Ä–µ—Å—Å–µ
            cursor.execute(
                '''
                INSERT INTO course_progress (user_id, current_day, last_message_date)
                VALUES (%s, 1, CURRENT_TIMESTAMP)
                ON CONFLICT (user_id) DO UPDATE
                SET is_active = TRUE,
                    current_day = 1,
                    last_message_date = CURRENT_TIMESTAMP
                ''',
                (user_id,)
            )
            
            conn.commit()
            logging.info(f"‚úÖ Course purchase created for user {user_id}")
            return True
        except Exception as e:
            logging.error(f"‚ùå Error creating course purchase: {e}")
            conn.rollback()
            return False
        finally:
            conn.close()
    
    def get_users_for_daily_messages(self):
        """–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –∫–æ—Ç–æ—Ä—ã–º –Ω—É–∂–Ω–æ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è"""
        conn = self.get_connection()
        if conn is None:
            return []
        
        cursor = conn.cursor()
        try:
            # –ù–∞—Ö–æ–¥–∏–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, —É –∫–æ—Ç–æ—Ä—ã—Ö:
            # 1. –ö—É—Ä—Å –∞–∫—Ç–∏–≤–µ–Ω (is_active = TRUE)
            # 2. –ü—Ä–æ—à–ª–æ –±–æ–ª–µ–µ 24 —á–∞—Å–æ–≤ —Å –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è
            # 3. –¢–µ–∫—É—â–∏–π –¥–µ–Ω—å <= 7 (–µ—Å–ª–∏ 7+ –¥–Ω–µ–π - –∫—É—Ä—Å –∑–∞–≤–µ—Ä—à–µ–Ω)
            cursor.execute('''
                SELECT cp.user_id, cp.current_day
                FROM course_progress cp
                WHERE cp.is_active = TRUE
                  AND cp.current_day <= 7
                  AND (
                    cp.last_message_date IS NULL
                    OR cp.last_message_date < NOW() - INTERVAL '24 hours'
                  )
            ''')
            
            users = cursor.fetchall()
            return users
            
        except Exception as e:
            logging.error(f"‚ùå Error getting users for daily messages: {e}")
            return []
        finally:
            conn.close()
    
    def get_course_content(self, day_number: int):
        """–ü–æ–ª—É—á–∞–µ—Ç –∫–æ–Ω—Ç–µ–Ω—Ç –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –¥–Ω—è –∫—É—Ä—Å–∞"""
        print(f"üîÑ –ó–∞–ø—Ä–∞—à–∏–≤–∞—é –∫–æ–Ω—Ç–µ–Ω—Ç –¥–Ω—è {day_number}")
        
        conn = self.get_connection()
        if not conn:
            print("‚ùå –ù–µ—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –ë–î")
            return None
        
        try:
            cursor = conn.cursor()
            cursor.execute(
                "SELECT messages, has_images, image_urls FROM course_content WHERE day_number = %s",
                (day_number,)
            )
            result = cursor.fetchone()
            
            if result:
                print(f"‚úÖ –ù–∞–π–¥–µ–Ω –∫–æ–Ω—Ç–µ–Ω—Ç –¥–Ω—è {day_number}")
                messages = result[0]
                has_images = result[1]
                image_urls = result[2] if result[2] else []
                
                # –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ç–∏–ø messages
                print(f"üìã –¢–∏–ø messages: {type(messages)}")
                
                # –ï—Å–ª–∏ messages —ç—Ç–æ —Å—Ç—Ä–æ–∫–∞ (JSON), –ø–∞—Ä—Å–∏–º –µ–µ
                if isinstance(messages, str):
                    try:
                        messages_list = json.loads(messages)
                        print(f"‚úÖ JSON —Ä–∞—Å–ø–∞—Ä—Å–µ–Ω, {len(messages_list)} —Å–æ–æ–±—â–µ–Ω–∏–π")
                    except Exception as e:
                        print(f"‚ùå –û—à–∏–±–∫–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞ JSON: {e}")
                        messages_list = [messages]  # –ò—Å–ø–æ–ª—å–∑—É–µ–º –∫–∞–∫ –æ–¥–Ω–æ —Å–æ–æ–±—â–µ–Ω–∏–µ
                elif isinstance(messages, list):
                    messages_list = messages
                else:
                    print(f"‚ö†Ô∏è –ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π —Ç–∏–ø messages: {type(messages)}")
                    messages_list = [str(messages)]
                
                return {
                    'messages': messages_list,
                    'has_images': has_images,
                    'image_urls': image_urls
                }
            else:
                print(f"‚ùå –ö–æ–Ω—Ç–µ–Ω—Ç –¥–Ω—è {day_number} –Ω–µ –Ω–∞–π–¥–µ–Ω –≤ –ë–î")
                return None
                
        except Exception as e:
            print(f"‚ùå –û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞ –¥–Ω—è {day_number}: {e}")
            import traceback
            traceback.print_exc()
            return None
        finally:
            conn.close()

    def update_user_progress(self, user_id, day_number):
        """–û–±–Ω–æ–≤–ª—è–µ—Ç –ø—Ä–æ–≥—Ä–µ—Å—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–æ—Å–ª–µ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π"""
        conn = self.get_connection()
        if conn is None:
            return False
        
        cursor = conn.cursor()
        try:
            cursor.execute('''
                UPDATE course_progress
                SET current_day = %s,
                    last_message_date = CURRENT_TIMESTAMP
                WHERE user_id = %s
            ''', (day_number + 1, user_id))  # –ü–µ—Ä–µ—Ö–æ–¥–∏–º –∫ —Å–ª–µ–¥—É—é—â–µ–º—É –¥–Ω—é
            
            # –ï—Å–ª–∏ –¥–µ–Ω—å 7 –∑–∞–≤–µ—Ä—à–µ–Ω, –æ—Ç–º–µ—á–∞–µ–º –∫—É—Ä—Å –∫–∞–∫ –Ω–µ–∞–∫—Ç–∏–≤–Ω—ã–π
            if day_number >= 7:
                cursor.execute('''
                    UPDATE course_progress
                    SET is_active = FALSE
                    WHERE user_id = %s
                ''', (user_id,))
            
            conn.commit()
            return True
        except Exception as e:
            logging.error(f"‚ùå Error updating user progress: {e}")
            conn.rollback()
            return False
        finally:
            conn.close()

    def create_payment(self, user_id, payment_id, amount, currency, payment_method):
        """–°–æ–∑–¥–∞–µ—Ç –∑–∞–ø–∏—Å—å –æ –ø–ª–∞—Ç–µ–∂–µ"""
        conn = self.get_connection()
        if not conn:
            return False
        
        try:
            cursor = conn.cursor()
            cursor.execute('''
                INSERT INTO payments (user_id, payment_id, amount, currency, payment_method, status)
                VALUES (%s, %s, %s, %s, %s, 'pending')
            ''', (user_id, payment_id, amount, currency, payment_method))
            conn.commit()
            return True
        except Exception as e:
            logging.error(f"‚ùå Error creating payment: {e}")
            return False
        finally:
            conn.close()

    def update_payment_status(self, payment_id, status):
        """–û–±–Ω–æ–≤–ª—è–µ—Ç —Å—Ç–∞—Ç—É—Å –ø–ª–∞—Ç–µ–∂–∞"""
        conn = self.get_connection()
        if not conn:
            return False
        
        try:
            cursor = conn.cursor()
            cursor.execute('''
                UPDATE payments 
                SET status = %s, completed_at = CURRENT_TIMESTAMP 
                WHERE payment_id = %s
            ''', (status, payment_id))
            
            if cursor.rowcount > 0:
                conn.commit()
                # –ü–æ–ª—É—á–∞–µ–º user_id –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
                cursor.execute('SELECT user_id FROM payments WHERE payment_id = %s', (payment_id,))
                user_id = cursor.fetchone()[0]
                return user_id
            return None
        except Exception as e:
            logging.error(f"‚ùå Error updating payment: {e}")
            return None
        finally:
            conn.close()

    def get_user_payment_status(self, user_id):
        """–ü—Ä–æ–≤–µ—Ä—è–µ—Ç, –µ—Å—Ç—å –ª–∏ —É—Å–ø–µ—à–Ω—ã–π –ø–ª–∞—Ç–µ–∂ —É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è"""
        conn = self.get_connection()
        if not conn:
            return False
        
        try:
            cursor = conn.cursor()
            cursor.execute('''
                SELECT status FROM payments 
                WHERE user_id = %s AND status = 'success'
                ORDER BY created_at DESC LIMIT 1
            ''', (user_id,))
            result = cursor.fetchone()
            return result is not None
        except Exception as e:
            logging.error(f"‚ùå Error checking payment: {e}")
            return False
        finally:
            conn.close()

    def is_course_active(self, user_id):
        """–ü—Ä–æ–≤–µ—Ä—è–µ—Ç, –∞–∫—Ç–∏–≤–µ–Ω –ª–∏ –∫—É—Ä—Å —É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è"""
        conn = self.get_connection()
        if not conn:
            return False
        
        try:
            cursor = conn.cursor()
            cursor.execute('''
                SELECT is_active FROM course_progress 
                WHERE user_id = %s 
                AND is_active = TRUE
            ''', (user_id,))
            
            return cursor.fetchone() is not None
        except Exception as e:
            logging.error(f"Error checking course status: {e}")
            return False
        finally:
            conn.close()

    @staticmethod
    def markdown_to_html(text):
        """–ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ—Ç Markdown –≤ HTML –¥–ª—è Telegram"""
        if not text:
            return text
        
        import re
        
        # **–∂–∏—Ä–Ω—ã–π** -> <b>–∂–∏—Ä–Ω—ã–π</b>
        text = re.sub(r'\*\*(.+?)\*\*', r'<b>\1</b>', text)
        # *–∫—É—Ä—Å–∏–≤* -> <i>–∫—É—Ä—Å–∏–≤</i>
        text = re.sub(r'\*(.+?)\*', r'<i>\1</i>', text, flags=re.DOTALL)
        # `–∫–æ–¥` -> <code>–∫–æ–¥</code>
        text = re.sub(r'`(.+?)`', r'<code>\1</code>', text)
        # [—Ç–µ–∫—Å—Ç](—Å—Å—ã–ª–∫–∞) -> <a href="—Å—Å—ã–ª–∫–∞">—Ç–µ–∫—Å—Ç</a>
        text = re.sub(r'\[(.+?)\]\((.+?)\)', r'<a href="\2">\1</a>', text)
        
        return text

db = DatabaseManager()